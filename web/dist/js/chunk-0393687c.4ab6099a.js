(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0393687c"],{"64ea":function(e,t,a){"use strict";var r=a("662f"),s=a.n(r);s.a},"662f":function(e,t,a){},"742b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"single-page-shadow"},[a("Card",{attrs:{shadow:"","dis-hover":!0}},[a("p",{attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"md-settings"}}),e._v("\n      用户配置\n    ")],1),a("Row",[a("Col",{attrs:{span:"7"}},[a("Card",{staticClass:"show-shadow",attrs:{"dis-hover":!0}},[a("p",{attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"md-add"}}),e._v("\n          添加用户\n        ")],1),a("div",{staticClass:"edittable-testauto-con"},[a("Form",{ref:"userinfova",attrs:{model:e.userinfo,rules:e.userinfoValidate}},[a("FormItem",{attrs:{label:"用户名",prop:"username"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.userinfo.username,callback:function(t){e.$set(e.userinfo,"username",t)},expression:"userinfo.username"}})],1),a("FormItem",{attrs:{label:"密码",prop:"password"}},[a("Input",{attrs:{placeholder:"请输入",type:"password"},model:{value:e.userinfo.password,callback:function(t){e.$set(e.userinfo,"password",t)},expression:"userinfo.password"}})],1),a("FormItem",{attrs:{label:"确认密码",prop:"confirmpassword"}},[a("Input",{attrs:{placeholder:"请输入",type:"password"},model:{value:e.userinfo.confirmpassword,callback:function(t){e.$set(e.userinfo,"confirmpassword",t)},expression:"userinfo.confirmpassword"}})],1),a("FormItem",{attrs:{label:"部门",prop:"department"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.userinfo.department,callback:function(t){e.$set(e.userinfo,"department",t)},expression:"userinfo.department"}})],1),a("FormItem",{attrs:{label:"姓名",prop:"username_chn"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.userinfo.username_chn,callback:function(t){e.$set(e.userinfo,"username_chn",t)},expression:"userinfo.username_chn"}})],1),a("FormItem",{attrs:{label:"角色",prop:"role"}},[a("Select",{attrs:{placeholder:"请选择"},model:{value:e.userinfo.role,callback:function(t){e.$set(e.userinfo,"role",t)},expression:"userinfo.role"}},[a("Option",{attrs:{value:"admin"}},[e._v("管理员")]),a("Option",{attrs:{value:"guest"}},[e._v("使用人")])],1)],1),a("FormItem",{attrs:{label:"电子邮箱",prop:"email"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:e.userinfo.email,callback:function(t){e.$set(e.userinfo,"email",t)},expression:"userinfo.email"}})],1),a("Button",{staticStyle:{"margin-left":"35%"},attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.registered(t)}}},[e._v("添加")])],1)],1)])],1),a("Col",{staticClass:"padding-left-10",attrs:{span:"17"}},[a("Card",{staticClass:"show-shadow",attrs:{"dis-hover":!0}},[a("p",{attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"md-people"}}),e._v("\n          系统用户表\n        ")],1),a("Input",{staticStyle:{width:"20%"},attrs:{placeholder:"请填写用户名",clearable:""},model:{value:e.query.username,callback:function(t){e.$set(e.query,"username",t)},expression:"query.username"}}),a("Input",{staticClass:"margin-left-10",staticStyle:{width:"20%"},attrs:{placeholder:"请填写部门",clearable:""},model:{value:e.query.department,callback:function(t){e.$set(e.query,"department",t)},expression:"query.department"}}),a("Button",{staticClass:"margin-left-10",attrs:{type:"primary"},on:{click:e.queryData}},[e._v("查询")]),a("Button",{staticClass:"margin-left-10",attrs:{type:"warning"},on:{click:e.queryCancel}},[e._v("重置")]),a("div",{staticClass:"edittable-con-1"},[a("Table",{attrs:{border:"",columns:e.columns,data:e.tableData,stripe:"",height:"520"},scopedSlots:e._u([{key:"action",fn:function(t){var r=t.row;return[1!==r.id?a("Button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.editPassModal(r)}}},[e._v("更改密码\n              ")]):e._e(),a("Button",{staticClass:"margin-left-10",attrs:{type:"info",size:"small"},on:{click:function(t){return e.editAuthModal(r)}}},[e._v("详细信息")]),"admin"!==r.Username?[1!==r.id?a("Button",{staticClass:"margin-left-10",attrs:{type:"warning",size:"small"},on:{click:function(t){return e.delUser(r)}}},[e._v("删除")]):e._e()]:e._e()]}}])})],1),a("br"),a("Page",{ref:"page",attrs:{total:e.totalNumber,"show-elevator":"","page-size":e.page_size},on:{"on-change":e.pageChange}})],1)],1)],1)],1),a("Modal",{attrs:{closable:!1,"mask-closable":!1,width:500},model:{value:e.editPasswordForm.modal,callback:function(t){e.$set(e.editPasswordForm,"modal",t)},expression:"editPasswordForm.modal"}},[a("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[e._v("修改用户密码")]),a("Form",{ref:"editPasswordForm",attrs:{model:e.editPasswordForm,"label-width":100,"label-position":"right",rules:e.passwordValidate}},[a("FormItem",{attrs:{label:"用户名"}},[a("Input",{attrs:{readonly:"readonly"},model:{value:e.editPasswordForm.username,callback:function(t){e.$set(e.editPasswordForm,"username",t)},expression:"editPasswordForm.username"}})],1),a("FormItem",{attrs:{label:"新密码",prop:"newPass"}},[a("Input",{attrs:{placeholder:"请输入新密码，至少6位字符",type:"password"},model:{value:e.editPasswordForm.newPass,callback:function(t){e.$set(e.editPasswordForm,"newPass",t)},expression:"editPasswordForm.newPass"}})],1),a("FormItem",{attrs:{label:"确认新密码",prop:"rePass"}},[a("Input",{attrs:{placeholder:"请再次输入新密码",type:"password"},model:{value:e.editPasswordForm.rePass,callback:function(t){e.$set(e.editPasswordForm,"rePass",t)},expression:"editPasswordForm.rePass"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(t){e.editPasswordForm.modal=!1}}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.savePassLoading},on:{click:e.saveEditPass}},[e._v("保存")])],1)],1),a("Modal",{on:{"on-ok":e.saveAuthInfo},model:{value:e.editAuthForm.modal,callback:function(t){e.$set(e.editAuthForm,"modal",t)},expression:"editAuthForm.modal"}},[a("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[e._v("用户信息")]),a("Form",{ref:"userUpdate",attrs:{model:e.editAuthForm,"label-position":"right"}},[a("FormItem",{attrs:{label:"用户名"}},[a("Input",{attrs:{readonly:"readonly"},model:{value:e.editAuthForm.username,callback:function(t){e.$set(e.editAuthForm,"username",t)},expression:"editAuthForm.username"}})],1),a("FormItem",{attrs:{label:"真实姓名"}},[a("Input",{model:{value:e.editAuthForm.username_chn,callback:function(t){e.$set(e.editAuthForm,"username_chn",t)},expression:"editAuthForm.username_chn"}})],1),a("FormItem",{attrs:{label:"角色"}},[a("Select",{attrs:{placeholder:"请选择"},model:{value:e.editAuthForm.role,callback:function(t){e.$set(e.editAuthForm,"role",t)},expression:"editAuthForm.role"}},[a("Option",{attrs:{value:"admin"}},[e._v("管理员")]),a("Option",{attrs:{value:"guest"}},[e._v("使用者")])],1)],1),a("FormItem",{attrs:{label:"部门"}},[a("Input",{attrs:{placeholder:"请输入新部门"},model:{value:e.editAuthForm.department,callback:function(t){e.$set(e.editAuthForm,"department",t)},expression:"editAuthForm.department"}})],1),a("FormItem",{attrs:{label:"E-mail"}},[a("Input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.editAuthForm.email,callback:function(t){e.$set(e.editAuthForm,"email",t)},expression:"editAuthForm.email"}})],1)],1)],1)],1)},s=[],o=(a("bc3a"),a("a32f"),a("34b7")),n={data:function(){var e=this,t=function(t,a,r){a!==e.editPasswordForm.newPass?r(new Error("两次输入密码不一致")):r()},a=function(t,a,r){a!==e.userinfo.password?r(new Error("两次输入密码不一致")):r()},r=function(t,a,r){var s=/^.*(?=.{6,})(?=.*\d)(?=.*[A-Z])(?=.*[a-z]).*$/;s.test(e.userinfo.password)?r():r(new Error("至少1个大写字母,1个小写字母,1个数字"))};return{query:{username:"",department:""},loading:!1,columns:[{title:"用户名",key:"username"},{title:"角色",key:"role"},{title:"姓名",key:"username_chn"},{title:"部门",key:"department"},{title:"email",key:"email"},{title:"操作",key:"action",width:250,align:"center",slot:"action"}],tableData:[],userinfo:{username:"",password:"",confirmpassword:"",role:"",department:"",email:"",username_chn:"",tenant:sessionStorage.getItem("tenant_name")},userinfoValidate:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"请至少输入6个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"},{validator:r,trigger:"blur"}],confirmpassword:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:a,trigger:"blur"}],role:[{required:!0,message:"请输入权限",trigger:"blur"}],department:[{required:!0,message:"请输入部门名称",trigger:"blur"},{min:2,message:"请至少输入6个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"}],username_chn:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,message:"请至少输入2个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"}],email:[{required:!0,message:"请输入工作邮箱",trigger:"blur"},{min:2,message:"请至少输入2个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"}]},editPasswordModal:!1,editPasswordForm:{username:"",newPass:"",rePass:"",modal:!1},savePassLoading:!1,passwordValidate:{newPass:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"请至少输入6个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"}],rePass:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:t,trigger:"blur"}]},editAuthForm:{username:"",department:"",username_chn:"",role:"",email:"",modal:!1},username:"",totalNumber:0,currentPage:1,page_size:15,tableLoading:!1,addLoading:!1,changePass:!1}},methods:{editPassModal:function(e){this.editPasswordForm=this.$config.sameMerge(this.editPasswordForm,e,this.editPasswordForm),this.editPasswordForm.modal=!0},editAuthModal:function(e){this.editAuthForm=this.$config.sameMerge(this.editAuthForm,e,this.editAuthForm),this.editAuthForm.modal=!0},saveEditPass:function(){var e=this;this.$refs["editPasswordForm"].validate((function(t){t&&(e.editPasswordForm.modal=!1,Object(o["m"])({username:e.editPasswordForm.username,password:e.editPasswordForm.newPass}).then((function(t){"success"===t.data.status?(e.$Message.success({content:"用户信息已保存 ",duration:5,closable:!0}),e.$refs["editPasswordForm"].resetFields()):e.$Message.error({content:"用户信息保存错误",duration:8,closable:!0})})).catch((function(t){e.bus.$emit("errorHandler",t)})).finally((function(){e.getData()})))}))},saveAuthInfo:function(){var e=this;this.$refs["editPasswordForm"].validate((function(t){t&&(e.editAuthForm.modal=!1,Object(o["m"])(e.editAuthForm).then((function(t){"success"===t.data.status?(e.$Message.success({content:"用户信息已保存 ",duration:5,closable:!0}),e.$refs["userUpdate"].resetFields()):e.$Message.error({content:"用户信息保存错误",duration:8,closable:!0})})).catch((function(t){console.log(t),e.bus.$emit("errorHandler",t)})).finally((function(){e.getData()})))}))},registered:function(){var e=this;this.$refs["userinfova"].validate((function(t){t&&e.$Modal.confirm({title:"请确认是否添加新用户信息","z-index":1010,onOk:function(){e.addLoading=!0,Object(o["c"])(e.userinfo).then((function(t){"success"===t.data.status?(e.$Message.success({content:"用户信息已经保存",duration:5,closable:!0}),e.$refs["userinfova"].resetFields()):e.$Message.error({content:"用户名重复或保存信息异常",duration:5,closable:!0})})).catch((function(t){e.bus.$emit("errorHandler",t)})).finally((function(){e.addLoading=!1,e.getData()}))},onCancel:function(){}})}))},getData:function(){var e=this;this.tableLoading=!0;var t=this.page_size,a=this.page_size*(this.currentPage-1);Object(o["i"])(t,a,this.query.username,this.query.department).then((function(t){console.log(t),e.tableData=t.data.data,e.totalNumber=t.data.count})).catch((function(t){e.bus.$emit("errorHandler",t)})).finally((function(){e.tableLoading=!1}))},delUser:function(e){var t=this;this.$Modal.confirm({title:"请确认是否删除用户信息","z-index":1010,onOk:function(){Object(o["e"])(e.username).then((function(e){"success"===e.data.status?t.$Message.success({content:"用户信息已删除",duration:5,closable:!0}):t.$Message.error({content:"删除用户信息异常",duration:5,closable:!0})})).catch((function(e){t.bus.$emit("errorHandler",e)})).finally((function(){t.getData()}))},onCancel:function(){}})},queryData:function(){this.query.valve=!0,this.getData()},queryCancel:function(){this.$config.clearObj(this.query),this.getData()},pageChange:function(e){this.currentPage=e,this.getData()}},mounted:function(){this.getData()}},i=n,l=(a("64ea"),a("2877")),u=Object(l["a"])(i,r,s,!1,null,"4fadc4a4",null);t["default"]=u.exports},a32f:function(e,t,a){}}]);
//# sourceMappingURL=chunk-0393687c.4ab6099a.js.map