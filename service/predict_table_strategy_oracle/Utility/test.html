
<html lang="cn">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head>
        <body class="awr"><title></title>
    
<style type="text/css">
body.awr {font:bold 10pt Arial,Helvetica,Geneva,sans-serif;color:black; background:White;}
pre.awr  {font:8pt Courier;color:black; background:White;}
h1.awr   {font:bold 20pt Arial,Helvetica,Geneva,sans-serif;color:#336699;background-color:White;border-bottom:1px solid #cccc99;margin-top:0pt; margin-bottom:0pt;padding:0px 0px 0px 0px;}
h2.awr   {font:bold 18pt Arial,Helvetica,Geneva,sans-serif;color:#336699;background-color:White;margin-top:4pt; margin-bottom:0pt;}
h3.awr {font:bold 16pt Arial,Helvetica,Geneva,sans-serif;color:#336699;background-color:White;margin-top:4pt; margin-bottom:0pt;}
li.awr {font: 8pt Arial,Helvetica,Geneva,sans-serif; color:black; background:White;}
th.awrnobg {font:bold 8pt Arial,Helvetica,Geneva,sans-serif; color:black; background:White;padding-left:4px; padding-right:4px;padding-bottom:2px}
th.awrbg {font:bold 8pt Arial,Helvetica,Geneva,sans-serif; color:White; background:#0066CC;padding-left:4px; padding-right:4px;padding-bottom:2px}
td.awrnc {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:White;vertical-align:top;}
td.awrc    {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:#FFFFCC; vertical-align:top;}
td.awrnclb {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:White;vertical-align:top;border-left: thin solid black;}
td.awrncbb {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:White;vertical-align:top;border-left: thin solid black;border-right: thin solid black;}
td.awrncrb {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:White;vertical-align:top;border-right: thin solid black;}
td.awrcrb    {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:#FFFFCC; vertical-align:top;border-right: thin solid black;}
td.awrclb    {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:#FFFFCC; vertical-align:top;border-left: thin solid black;}
td.awrcbb    {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:#FFFFCC; vertical-align:top;border-left: thin solid black;border-right: thin solid black;}
a.awr {font:bold 8pt Arial,Helvetica,sans-serif;color:#663300; vertical-align:top;margin-top:0pt; margin-bottom:0pt;}
td.awrnct {font:8pt Arial,Helvetica,Geneva,sans-serif;border-top: thin solid black;color:black;background:White;vertical-align:top;}
td.awrct   {font:8pt Arial,Helvetica,Geneva,sans-serif;border-top: thin solid black;color:black;background:#FFFFCC; vertical-align:top;}
td.awrnclbt  {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:White;vertical-align:top;border-top: thin solid black;border-left: thin solid black;}
td.awrncbbt  {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:White;vertical-align:top;border-left: thin solid black;border-right: thin solid black;border-top: thin solid black;}
td.awrncrbt {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:White;vertical-align:top;border-top: thin solid black;border-right: thin solid black;}
td.awrcrbt     {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:#FFFFCC; vertical-align:top;border-top: thin solid black;border-right: thin solid black;}
td.awrclbt     {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:#FFFFCC; vertical-align:top;border-top: thin solid black;border-left: thin solid black;}
td.awrcbbt   {font:8pt Arial,Helvetica,Geneva,sans-serif;color:black;background:#FFFFCC; vertical-align:top;border-top: thin solid black;border-left: thin solid black;border-right: thin solid black;}
table.tdiff {  border_collapse: collapse; }
.hidden   {position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;}
.pad   {margin-left:10px;}
.doublepad {margin-left:34px;}
</style>
    <h3 class="awr">报告</h3><p>发现35张表,前10个出现频率最高的表为</p>
<p>
    <table border="0" width="600" class="tdiff" summary="auto generate">
        <tbody>
    			<tr>
				<th class="awrbg" scope="col"><pre>表名</pre></th>
				<th class="awrbg" scope="col"><pre>出现次数(次/天)</pre></th>
			</tr>
			<tr>
				<td scope="row" class="awrc"><pre>APP_TRANS</pre></td>
				<td align="left" class="awrc"><pre>455</pre></td>
			</tr>
			<tr>
				<td scope="row" class="awrnc"><pre>H_APP_TRANS</pre></td>
				<td align="left" class="awrnc"><pre>424</pre></td>
			</tr>
			<tr>
				<td scope="row" class="awrc"><pre>ACK_TRANS</pre></td>
				<td align="left" class="awrc"><pre>272</pre></td>
			</tr>
			<tr>
				<td scope="row" class="awrnc"><pre>ARK_BAL_FUND_HIS</pre></td>
				<td align="left" class="awrnc"><pre>198</pre></td>
			</tr>
			<tr>
				<td scope="row" class="awrc"><pre>H_ACK_TRANS</pre></td>
				<td align="left" class="awrc"><pre>184</pre></td>
			</tr>
			<tr>
				<td scope="row" class="awrnc"><pre>CFG_FUND</pre></td>
				<td align="left" class="awrnc"><pre>82</pre></td>
			</tr>
			<tr>
				<td scope="row" class="awrc"><pre>ARK_BAL_FUND</pre></td>
				<td align="left" class="awrc"><pre>17</pre></td>
			</tr>
			<tr>
				<td scope="row" class="awrnc"><pre>SALE_ACCT_MONEYACCOUNT</pre></td>
				<td align="left" class="awrnc"><pre>13</pre></td>
			</tr>
			<tr>
				<td scope="row" class="awrc"><pre>SALE_APP_BACKBALANCE</pre></td>
				<td align="left" class="awrc"><pre>6</pre></td>
			</tr>
			<tr>
				<td scope="row" class="awrnc"><pre>ACK_ACCT</pre></td>
				<td align="left" class="awrnc"><pre>6</pre></td>
			</tr>

         </tbody>
    </table>
</p>
<p></p>
    <p>其中17.14%(6个)表有足够的统计意义可以构建索引策略</p><h3 class="awr">DDL</h3><p></p><li class="awr">CREATE INDEX ARKDATA.APP_TRANS_INDEX0 ON APP_TRANS(TAACCOUNTID) ONLINE COMPUTE STATISTICS;</li><li class="awr">CREATE INDEX ARKDATA.APP_TRANS_INDEX1 ON APP_TRANS(CUSTFULLNAME,APPSHEETSERIALNO) ONLINE COMPUTE STATISTICS;</li><li class="awr">CREATE INDEX ARKDATA.H_APP_TRANS_INDEX0 ON H_APP_TRANS(CUSTFULLNAME) ONLINE COMPUTE STATISTICS;</li><li class="awr">CREATE INDEX ARKDATA.ACK_TRANS_INDEX0 ON ACK_TRANS(SNO) ONLINE COMPUTE STATISTICS;</li><li class="awr">CREATE INDEX ARKDATA.ACK_TRANS_INDEX1 ON ACK_TRANS(CONFIRMEDVOL,CONFIRMEDAMOUNT) ONLINE COMPUTE STATISTICS;</li><li class="awr">CREATE INDEX ARKDATA.ARK_BAL_FUND_HIS_INDEX0 ON ARK_BAL_FUND_HIS(BAL_FUND) ONLINE COMPUTE STATISTICS;</li><li class="awr">CREATE INDEX ARKDATA.H_ACK_TRANS_INDEX0 ON H_ACK_TRANS(CUSTNO) ONLINE COMPUTE STATISTICS;</li><p></p><h3 class="awr">Overall Performance</h3><p></p>
<p>
    <table border="0" width="600" class="tdiff" summary="auto generate">
        <tbody>
        			<tr>
				<th class="awrbg" scope="col"><pre>表名</pre></th>
				<td align="left" class="awrc"><pre>ark.ARKDATA.APP_TRANS</pre></td>
			</tr>
			<tr>
				<th rowspan="4" class="awrbg" scope ="col"><pre>构建索引</pre></th>
				<td align="left" class="awrnc"><pre> ARKDATA.APP_TRAN0 (TAACCOUNTID)</pre></td>
			</tr>
			<tr>
				<td align="left" class="awrc"><pre> ARKDATA.APP_TRAN1 (CUSTFULLNAME,APPSHEETSERIALNO)</pre></td>
			</tr>
			<tr>
				<td align="left" class="awrnc"><pre>aaaa</pre></td>
			</tr>
			<tr>
				<td align="left" class="awrc"><pre>bbbb</pre></td>
			</tr>
			<tr>
				<th class="awrbg" scope="col"><pre>性能最多提高 99.99%</pre></th>
				<td align="left" class="awrnc"><pre>其中有 2.96% 的sql性能提高, 96.90% 的sql性能不变, 0.14% 的sql性能变差</pre></td>
			</tr>

         </tbody>
    </table>
</p>
<p></p>
        
<p>
    <table border="0" width="600" class="tdiff" summary="auto generate">
        <tbody>
        			<tr>
				<th class="awrbg" scope="col"><pre>表名</pre></th>
				<td align="left" class="awrc"><pre>ark.ARKDATA.APP_TRANS</pre></td>
			</tr>
			<tr>
				<th rowspan="4" class="awrbg" scope ="col"><pre>构建索引</pre></th>
				<td align="left" class="awrnc"><pre> ARKDATA.APP_TRAN0 (TAACCOUNTID)</pre></td>
			</tr>
			<tr>
				<td align="left" class="awrc"><pre> ARKDATA.APP_TRAN1 (CUSTFULLNAME,APPSHEETSERIALNO)</pre></td>
			</tr>
			<tr>
				<td align="left" class="awrnc"><pre>aaaa</pre></td>
			</tr>
			<tr>
				<td align="left" class="awrc"><pre>bbbb</pre></td>
			</tr>
			<tr>
				<th class="awrbg" scope="col"><pre>性能最多提高 99.99%</pre></th>
				<td align="left" class="awrnc"><pre>其中有 2.96% 的sql性能提高, 96.90% 的sql性能不变, 0.14% 的sql性能变差</pre></td>
			</tr>

         </tbody>
    </table>
</p>
<p></p>
        <h3 class="awr">Performance in Detail</h3><p>ark.ARKDATA.H_APP_TRANS 对应的sql id:</p><li class="awr"> <a class="awr" href="#8qx6ph55d9bbw">8qx6ph55d9bbw</a></li><li class="awr"> <a class="awr" href="#1t78nzzrqht48">1t78nzzrqht48</a></li><li class="awr"> <a class="awr" href="#5nmfd3jpn4cf7">5nmfd3jpn4cf7</a></li><li class="awr"> <a class="awr" href="#7j9gtt88jxm4f">7j9gtt88jxm4f</a></li><li class="awr"> <a class="awr" href="#92rucz19dzqyw">92rucz19dzqyw</a></li>
<p>
    <table border="0" width="600" class="tdiff" summary="auto generate">
        <tbody>
        			<tr>
				<th class="awrbg" scope="col"><pre>sql_id</pre></th>
				<td align="left" class="awrc"><pre><a name="8qx6ph55d9bbw">8qx6ph55d9bbw</a></pre></td>
			</tr>
			<tr>
				<th class="awrbg" scope="col"><pre>sql_text</pre></th>
				<td align="left" class="awrnc"><pre>
    select count(1) tmpCount 
	from app_trans a left join cfg_fund c on a.fundcode = c.fundcode
        where a.transactiondate >= '20170515'         
	and a.is_delete = '0'                      
	and a.transactiondate >= :1
   	and a.transactiondate<= :2
        and a.cancelflag= 3
        and a.custfullname like '%'||:4 ||'%'
        union all
	select count(1) tmpCount 
	from h_app_trans b left join cfg_fund d on b.fundcode = d.fundcode                  
	where b.transactiondate <= '20170514'
	and b.transactiondate  >= :5  
	and b.transactiondate  <= :6 
	and b.cancelflag=:7                 
                               </pre></td>
			</tr>
			<tr>
				<th class="awrbg" scope="col"><pre>原始执行执行计划</pre></th>
				<td align="left" class="awrnc"><pre>
    Plan hash value: 1134915831

---------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                       | Name                    | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
---------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                |                         |     1 |    13 |   107K  (1)| 00:21:31 |       |       |
|   1 |  SORT AGGREGATE                 |                         |     1 |    13 |            |          |       |       |
|   2 |   VIEW                          |                         |     2 |    26 |   107K  (1)| 00:21:31 |       |       |
|   3 |    UNION-ALL                    |                         |       |       |            |          |       |       |
|   4 |     SORT AGGREGATE              |                         |     1 |    27 |            |          |       |       |
|*  5 |      TABLE ACCESS BY INDEX ROWID| APP_TRANS               |  1442 | 38934 |  3955   (1)| 00:00:48 |       |       |
|*  6 |       INDEX RANGE SCAN          | IDX_APP_TRANS_DATE_CODE | 10383 |       |  1310   (1)| 00:00:16 |       |       |
|   7 |     SORT AGGREGATE              |                         |     1 |    25 |            |          |       |       |
|   8 |      PARTITION RANGE AND        |                         |   275 |  6875 |   103K  (1)| 00:20:44 |KEY(AP)|KEY(AP)|
|*  9 |       TABLE ACCESS FULL         | H_APP_TRANS             |   275 |  6875 |   103K  (1)| 00:20:44 |KEY(AP)|KEY(AP)|
---------------------------------------------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   5 - filter("A"."CANCELFLAG"=:3 AND "A"."CUSTFULLNAME" LIKE '%'||:4||'%' AND "A"."IS_DELETE"='0')
   6 - access("A"."TRANSACTIONDATE">='20170515' AND "A"."TRANSACTIONDATE"<=:2)
       filter("A"."TRANSACTIONDATE">=:1)
   9 - filter("B"."TRANSACTIONDATE">=:5 AND "B"."TRANSACTIONDATE"<=:6 AND "B"."CANCELFLAG"=:7 AND
              "B"."CUSTFULLNAME" LIKE '%'||:8||'%' AND "B"."TRANSACTIONDATE"<='20170514')
                   </pre></td>
			</tr>
			<tr>
				<th class="awrbg" scope="col"><pre>加入索引后的执行计划</pre></th>
				<td align="left" class="awrnc"><pre>
    Plan hash value: 911165992

----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                              | Name        | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                       |             |     1 |    13 |    20   (0)| 00:00:01 |       |       |
|   1 |  SORT AGGREGATE                        |             |     1 |    13 |            |          |       |       |
|   2 |   VIEW                                 |             |     2 |    26 |    20   (0)| 00:00:01 |       |       |
|   3 |    UNION-ALL                           |             |       |       |            |          |       |       |
|   4 |     SORT AGGREGATE                     |             |     1 |    27 |            |          |       |       |
|*  5 |      TABLE ACCESS BY INDEX ROWID       | APP_TRANS   |  1442 | 38934 |    10   (0)| 00:00:01 |       |       |
|*  6 |       INDEX RANGE SCAN                 | APP_TRAN1   |   207K|       |     2   (0)| 00:00:01 |       |       |
|   7 |     SORT AGGREGATE                     |             |     1 |    25 |            |          |       |       |
|*  8 |      TABLE ACCESS BY GLOBAL INDEX ROWID| H_APP_TRANS |   275 |  6875 |    10   (0)| 00:00:01 | ROWID | ROWID |
|*  9 |       INDEX RANGE SCAN                 | H_APP_TRAN0 | 39947 |       |     2   (0)| 00:00:01 |       |       |
----------------------------------------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   5 - filter("A"."TRANSACTIONDATE">=:1 AND "A"."TRANSACTIONDATE"<=:2 AND "A"."CANCELFLAG"=:3 AND
              "A"."IS_DELETE"='0' AND "A"."TRANSACTIONDATE">='20170515')
   6 - access("A"."CUSTFULLNAME" LIKE '%'||:4||'%')
       filter("A"."CUSTFULLNAME" LIKE '%'||:4||'%')
   8 - filter("B"."TRANSACTIONDATE">=:5 AND "B"."TRANSACTIONDATE"<=:6 AND "B"."CANCELFLAG"=:7 AND
              "B"."TRANSACTIONDATE"<='20170514')
   9 - access("B"."CUSTFULLNAME" LIKE '%'||:8||'%')
       filter("B"."CUSTFULLNAME" LIKE '%'||:8||'%')
    </pre></td>
			</tr>

         </tbody>
    </table>
</p>
<p></p>
        <p></p>
<p>
    <table border="0" width="600" class="tdiff" summary="auto generate">
        <tbody>
        			<tr>
				<th class="awrbg" scope="col"><pre>sql_id</pre></th>
				<td align="left" class="awrc"><pre><a name="8qx6ph55d9bbw">8qx6ph55d9bbw</a></pre></td>
			</tr>
			<tr>
				<th class="awrbg" scope="col"><pre>sql_text</pre></th>
				<td align="left" class="awrnc"><pre>
                      select count(1) tmpCount 
                  	from app_trans a left join cfg_fund c on a.fundcode = c.fundcode
                          where a.transactiondate >= '20170515'         
                  	and a.is_delete = '0'                      
                  	and a.transactiondate >= :1
                     	and a.transactiondate<= :2
                          and a.cancelflag= 3
                          and a.custfullname like '%'||:4 ||'%'
                          union all
                  	select count(1) tmpCount 
                  	from h_app_trans b left join cfg_fund d on b.fundcode = d.fundcode                  
                  	where b.transactiondate <= '20170514'
                  	and b.transactiondate  >= :5  
                  	and b.transactiondate  <= :6 
                  	and b.cancelflag=:7                 
                                                 </pre></td>
			</tr>
			<tr>
				<th class="awrbg" scope="col"><pre>原始执行执行计划</pre></th>
				<td align="left" class="awrnc"><pre>
                      Plan hash value: 1134915831

                  ---------------------------------------------------------------------------------------------------------------------------
                  | Id  | Operation                       | Name                    | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
                  ---------------------------------------------------------------------------------------------------------------------------
                  |   0 | SELECT STATEMENT                |                         |     1 |    13 |   107K  (1)| 00:21:31 |       |       |
                  |   1 |  SORT AGGREGATE                 |                         |     1 |    13 |            |          |       |       |
                  |   2 |   VIEW                          |                         |     2 |    26 |   107K  (1)| 00:21:31 |       |       |
                  |   3 |    UNION-ALL                    |                         |       |       |            |          |       |       |
                  |   4 |     SORT AGGREGATE              |                         |     1 |    27 |            |          |       |       |
                  |*  5 |      TABLE ACCESS BY INDEX ROWID| APP_TRANS               |  1442 | 38934 |  3955   (1)| 00:00:48 |       |       |
                  |*  6 |       INDEX RANGE SCAN          | IDX_APP_TRANS_DATE_CODE | 10383 |       |  1310   (1)| 00:00:16 |       |       |
                  |   7 |     SORT AGGREGATE              |                         |     1 |    25 |            |          |       |       |
                  |   8 |      PARTITION RANGE AND        |                         |   275 |  6875 |   103K  (1)| 00:20:44 |KEY(AP)|KEY(AP)|
                  |*  9 |       TABLE ACCESS FULL         | H_APP_TRANS             |   275 |  6875 |   103K  (1)| 00:20:44 |KEY(AP)|KEY(AP)|
                  ---------------------------------------------------------------------------------------------------------------------------

                  Predicate Information (identified by operation id):
                  ---------------------------------------------------

                     5 - filter("A"."CANCELFLAG"=:3 AND "A"."CUSTFULLNAME" LIKE '%'||:4||'%' AND "A"."IS_DELETE"='0')
                     6 - access("A"."TRANSACTIONDATE">='20170515' AND "A"."TRANSACTIONDATE"<=:2)
                         filter("A"."TRANSACTIONDATE">=:1)
                     9 - filter("B"."TRANSACTIONDATE">=:5 AND "B"."TRANSACTIONDATE"<=:6 AND "B"."CANCELFLAG"=:7 AND
                                "B"."CUSTFULLNAME" LIKE '%'||:8||'%' AND "B"."TRANSACTIONDATE"<='20170514')
                                     </pre></td>
			</tr>
			<tr>
				<th class="awrbg" scope="col"><pre>加入索引后的执行计划</pre></th>
				<td align="left" class="awrnc"><pre>
                      Plan hash value: 911165992

                  ----------------------------------------------------------------------------------------------------------------------
                  | Id  | Operation                              | Name        | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
                  ----------------------------------------------------------------------------------------------------------------------
                  |   0 | SELECT STATEMENT                       |             |     1 |    13 |    20   (0)| 00:00:01 |       |       |
                  |   1 |  SORT AGGREGATE                        |             |     1 |    13 |            |          |       |       |
                  |   2 |   VIEW                                 |             |     2 |    26 |    20   (0)| 00:00:01 |       |       |
                  |   3 |    UNION-ALL                           |             |       |       |            |          |       |       |
                  |   4 |     SORT AGGREGATE                     |             |     1 |    27 |            |          |       |       |
                  |*  5 |      TABLE ACCESS BY INDEX ROWID       | APP_TRANS   |  1442 | 38934 |    10   (0)| 00:00:01 |       |       |
                  |*  6 |       INDEX RANGE SCAN                 | APP_TRAN1   |   207K|       |     2   (0)| 00:00:01 |       |       |
                  |   7 |     SORT AGGREGATE                     |             |     1 |    25 |            |          |       |       |
                  |*  8 |      TABLE ACCESS BY GLOBAL INDEX ROWID| H_APP_TRANS |   275 |  6875 |    10   (0)| 00:00:01 | ROWID | ROWID |
                  |*  9 |       INDEX RANGE SCAN                 | H_APP_TRAN0 | 39947 |       |     2   (0)| 00:00:01 |       |       |
                  ----------------------------------------------------------------------------------------------------------------------

                  Predicate Information (identified by operation id):
                  ---------------------------------------------------

                     5 - filter("A"."TRANSACTIONDATE">=:1 AND "A"."TRANSACTIONDATE"<=:2 AND "A"."CANCELFLAG"=:3 AND
                                "A"."IS_DELETE"='0' AND "A"."TRANSACTIONDATE">='20170515')
                     6 - access("A"."CUSTFULLNAME" LIKE '%'||:4||'%')
                         filter("A"."CUSTFULLNAME" LIKE '%'||:4||'%')
                     8 - filter("B"."TRANSACTIONDATE">=:5 AND "B"."TRANSACTIONDATE"<=:6 AND "B"."CANCELFLAG"=:7 AND
                                "B"."TRANSACTIONDATE"<='20170514')
                     9 - access("B"."CUSTFULLNAME" LIKE '%'||:8||'%')
                         filter("B"."CUSTFULLNAME" LIKE '%'||:8||'%')
                      </pre></td>
			</tr>
			<tr>
				<th class="awrbg" scope="col"><pre>性能</pre></th>
				<td align="left" class="awrnc"><pre>提升90%</pre></td>
			</tr>

         </tbody>
    </table>
</p>
<p></p>
        <p></p>
    </body>
</html>
    